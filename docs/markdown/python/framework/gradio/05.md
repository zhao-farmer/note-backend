# 五、一些示例

## 5.1 基础示例

1. 代码

    ```py
    """
    这段代码使用Gradio库创建了一个简单的计算器应用。应用中定义了一个名为calculator的函数，它接受三个参数：num1（第一个数字）、operation（操作符）和num2（第二个数字）。根据操作符的不同，函数会执行相应的计算操作，包括加法、减法、乘法和除法。如果除法操作中的第二个数字为零，会抛出一个gr.Error异常。
    """
    import gradio as gr
    
    # from foo import BAR
    #
    def calculator(num1, operation, num2):
        if operation == "add":
            return num1 + num2
        elif operation == "subtract":
            return num1 - num2
        elif operation == "multiply":
            return num1 * num2
        elif operation == "divide":
            if num2 == 0:
                raise gr.Error("Cannot divide by zero!")
            return num1 / num2
    
    demo = gr.Interface(
        calculator,
        [
            "number",
            gr.Radio(["add", "subtract", "multiply", "divide"]),
            "number"
        ],
        "number",
        examples=[
            [45, "add", 3],
            [3.14, "divide", 2],
            [144, "multiply", 2.5],
            [0, "subtract", 1.2],
        ],
        title="Toy Calculator",
        description="Here's a sample toy calculator. Allows you to calculate things like $2+2=4$",
    )
    demo.launch()
    ```
2. 带有样例的输入

    概述：提供输入数据样例，主要是通过examples关键字，提供一个嵌套列表。
    
    每选择一种类型，input框内就会展示对应的数据

    ![](/python/framework/gradio/011.png)

2. 提示弹窗

    提示弹窗：当遇到错误时以弹窗的形式弹出，如上边例子中除以0的时候会引发的错误（gr.Error(“Cannot divide by zero!”)），也可以使用gr.Warning 或者 gr.Info 来告警。

    ![](/python/framework/gradio/012.png)

3. 描述内容
    
    概述：接口中的一些参数可以帮助理解APP，如下方图片，分别对应三个参数的内容。

    - title：标题
    - description： 描述性内容
    - article：最下方的描述

    ![](/python/framework/gradio/013.png)

4. 风格

    概述：选择界面风格


    1. 代码添加风格

        ```py
        """
        这段代码使用Gradio库创建了一个简单的计算器应用。应用中定义了一个名为calculator的函数，它接受三个参数：num1（第一个数字）、operation（操作符）和num2（第二个数字）。根据操作符的不同，函数会执行相应的计算操作，包括加法、减法、乘法和除法。如果除法操作中的第二个数字为零，会抛出一个gr.Error异常。
        """
        import gradio as gr


        # from foo import BAR
        #
        def calculator(num1, operation, num2):
            if operation == "add":
                return num1 + num2
            elif operation == "subtract":
                return num1 - num2
            elif operation == "multiply":
                return num1 * num2
            elif operation == "divide":
                if num2 == 0:
                    raise gr.Error("Cannot divide by zero!")
                return num1 / num2


        demo = gr.Interface(
            calculator,
            [
                "number",
                gr.Radio(["add", "subtract", "multiply", "divide"]),
                "number"
            ],
            "number",
            examples=[
                [45, "add", 3],
                [3.14, "divide", 2],
                [144, "multiply", 2.5],
                [0, "subtract", 1.2],
            ],
            title="Toy Calculator",
            description="Here's a sample toy calculator. Allows you to calculate things like $2+2=4$",
            article="下方的信息",
            theme=gr.themes.Monochrome()
        )

        demo.launch()
        ```
    2. 输出结果

        ![](/python/framework/gradio/014.png)

## 5.2 流式输出

概述：流式输出文字，一个个输出，而不是全部输出，这里用到了关键字yield。这里我们使用time.sleep(0.1)来手动的让每个文字输出有间隔。

1. 代码示例

    ```py
    import random
    import time
    import gradio as gr
    
    def random_response(message, history):
        responses = [
            "谢谢您的留言！",
            "非常有趣！",
            "我不确定该如何回答。",
            "请问还有其他问题吗？",
            "我会尽快回复您的。",
            "很高兴能与您交流！",
        ]
        # 逐步生成回复
        responses = random.choice(responses)
        responses_so_far = ""
        for char in responses:
            responses_so_far += char
            time.sleep(0.1)
            yield responses_so_far
    
    demo = gr.ChatInterface(random_response, title='ㄣ知冷煖★')
    demo.launch()
    ```

2. 运行结果

    ![](/python/framework/gradio/015.png)


## 5.3 进度条

概述：Gradio支持创建自定义进度条，只需要在方法中添加progress=gr.Progress()，即可，可以直接通过调用实例并赋值来更新进度条，如progress(0.05)，也可以使用其中的tqdm方法来跟踪迭代更新进度。


1. 代码示例

    ```py
    
    import gradio as gr
    import time
    
    def slowly_reverse(word, progress=gr.Progress()):
        progress(0, desc="Starting")
        time.sleep(1)
        progress(0.05)
        new_string = ""
        for letter in progress.tqdm(word, desc="Reversing"):
            time.sleep(0.25)
            new_string = letter + new_string
        return new_string
    
    demo = gr.Interface(slowly_reverse, gr.Text(), gr.Text())
    demo.launch()
    ```

2. 运行结果

    ![](/python/framework/gradio/016.png)